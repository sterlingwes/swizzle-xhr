!function(){"use strict";window.swizzleXHR=function({responseTransform:n,urlFilter:t,debug:o}){const r=window.XMLHttpRequest,s=e=>Array.prototype.slice.call(e,0),c=function(){if(!o)return;const e=s(arguments);e.unshift("[swizzle-xhr]"),console.log.apply(console,e)};return function(){let a,i=new r,u={};const f={},l=(e,n)=>{f[e]||(f[e]=[]),f[e].push(n)},d=(o,r)=>{const s=()=>{f[o]?f[o].forEach(e=>{"function"!=typeof e.handleEvent?"function"==typeof e?e.call(i,r):c("encountered unexpected handler",o,e):e.handleEvent(r)}):c("handleResponse called with no handler set for "+o)};!n||t&&!t.test(i.responseURL)?s():Promise.resolve(n(i)).then(n=>{u=(n=>{const t={};return e.forEach(e=>{e in n&&(t[e]=n[e])}),t})(n);try{s()}catch(e){c("applyLoaded() encountered error",e)}})},p={onload:function(e){c(a,"loaded"),d("onload",e)},onreadystatechange:function(e){c(a,"readyState="+this.readyState),4===this.readyState&&d("onreadystatechange",e)}};return Object.keys(p).forEach(e=>{i[e]=p[e]}),new Proxy(i,{get:function(e,n,t){if(u[n])return u[n];if("response"===n&&u.responseText)return u.responseText;if("addEventListener"===n)return function(){const[e,n]=s(arguments),t="on"+e;let o={};"function"==typeof n&&(o.handleEvent=n),l(t,o)};if(o&&"open"===n)return function(){const t="method="+(Object.keys(f).join(",")||"addEventListener"),o=s(arguments);return a=`${o[0]}:${o[1]}`,c("open",t,a),e[n].apply(i,arguments)};const r=Reflect.get(e,n);return"function"==typeof r?r.bind(e):r},set:function(e,n,t){const o=p[n];return o?(l(n,t),Reflect.set(e,n,o)):Reflect.set(e,n,t)}})}};const e=["responseText","responseType","responseURL","status","statusText"]}();
