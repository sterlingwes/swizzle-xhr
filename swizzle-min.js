!function(){"use strict";window.swizzleXHR=function({responseTransform:n,urlFilter:t,debug:o}){const r=window.XMLHttpRequest,s=e=>Array.prototype.slice.call(e,0),c=function(){if(!o)return;const e=s(arguments);e.unshift("[swizzle-xhr]"),console.log.apply(console,e)};return function(){let a,i,u=new r,f={};const l={},d=(e,n)=>{l[e]||(l[e]=[]),l[e].push(n)},p=(o,r)=>{const s=()=>{l[o]?l[o].forEach(e=>{"function"!=typeof e.handleEvent?"function"==typeof e?e.call(u,r):c("encountered unexpected handler",o,e):e.handleEvent(r)}):c("handleResponse called with no handler set for "+o)};!n||t&&!t.test(u.responseURL)?s():(i||(i=Promise.resolve(n(u)),i)).then(n=>{f=(n=>{const t=n||{},o={};return e.forEach(e=>{e in t&&(o[e]=t[e])}),o})(n);try{s()}catch(e){c("applyLoaded() encountered error",e)}})},h={onload:function(e){c(a,"loaded"),p("onload",e)},onreadystatechange:function(e){c(a,"readyState="+this.readyState),4===this.readyState&&p("onreadystatechange",e)}};return Object.keys(h).forEach(e=>{u[e]=h[e]}),new Proxy(u,{get:function(e,n,t){if(f[n])return f[n];if("response"===n&&f.responseText)return f.responseText;if("addEventListener"===n)return function(){const[e,n]=s(arguments),t="on"+e;let o={};"function"==typeof n&&(o.handleEvent=n),d(t,o)};if(o&&"open"===n)return function(){const t="method="+(Object.keys(l).join(",")||"addEventListener"),o=s(arguments);return a=`${o[0]}:${o[1]}`,c("open",t,a),e[n].apply(u,arguments)};const r=Reflect.get(e,n);return"function"==typeof r?r.bind(e):r},set:function(e,n,t){const o=h[n];return o?(d(n,t),Reflect.set(e,n,o)):Reflect.set(e,n,t)}})}};const e=["responseText","responseType","responseURL","status","statusText"]}();
